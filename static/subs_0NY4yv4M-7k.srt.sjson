{"start":[0,2175,4125,6870,9720,13335,15570,18480,20280,21660,25800,27900,30760,33780,38570,39780,44154,45720,48985,61400,66925,69710,71480,74784,77255,83240,85785,89630,91250,92555,94160,96770,100145,102830,104570,108310,110480,112190,113600,115370,116480,117890,121200,123320,125537,126740,128150,131160,133100,137625,139940,142530,147080,149120,153000,155660,158600,160495,164505,165900,167820,170505,173037,175540,176740,178365,180710,183060,184890,186815,190080,191370,193230,195470,196740,198360,199705,201420,204205,208080,210030,212235,214932,216765,221670,225255,229473,231475,234815,237200,240320,241805,243970,245360,247035,250295,255025,256640,261418,264000,265370,266810,268630,270975,273380,275930,279180,281810,285635,288020,290690,292775,298275,303160,304295,305710,307785,309845,312121,314290,318365,321740,323165,325320,328774,330445,333220,335770,337720,339940,342745,346535,350860,352700,358435,362990,365870,368488,370115,374190,375660,376880,378380,381205,385310,387260,389610,392535,395960,398305,399860,401475,402950,405845,407390,408620,410240,412010,412675,414740,416325,417890,419976,423305,425735,429360,431630,433940,437563,441840,446675,449900,451460,453380,455060,457760,460330,462030,465785,469395,473080,476460,478290,481815,485095,487767,494510,497855,499700,502855,505700,508355,510875,512360,517355,519350,521990,523580,525405,527885,530560,531820,534660,536060,538153,539360,540740],"end":[2175,4125,6870,9720,13335,15570,18480,20280,21660,25800,27900,30760,33780,38570,39780,44154,45720,48985,61400,66925,69710,71480,74784,77255,83240,85785,89630,91250,92555,94160,96770,100145,102830,104570,108310,110480,112190,113600,115370,116480,117890,121200,123320,125537,126740,128150,131160,133100,137625,139940,142530,147080,149120,153000,155660,158600,160495,164505,165900,167820,170505,173037,175540,176740,178365,180710,183060,184890,186815,190080,191370,193230,195470,196740,198360,199705,201420,204205,208080,210030,212235,214932,216765,221670,225255,229473,231475,234815,237200,240320,241805,243970,245360,247035,250295,255025,256640,261418,264000,265370,266810,268630,270975,273380,275930,279180,281810,285635,288020,290690,292775,298275,303160,304295,305710,307785,309845,312121,314290,318365,321740,323165,325320,328774,330445,333220,335770,337720,339940,342745,346535,350860,352700,358435,362990,365870,368488,370115,374190,375660,376880,378380,381205,385310,387260,389610,392535,395960,398305,399860,401475,402950,405845,407390,408620,410240,412010,412675,414740,416325,417890,419976,423305,425735,429360,431630,433940,437563,441840,446675,449900,451460,453380,455060,457760,460330,462030,465785,469395,473080,476460,478290,481815,485095,487767,494510,497855,499700,502855,505700,508355,510875,512360,517355,519350,521990,523580,525405,527885,530560,531820,534660,536060,538153,539360,540740,544000],"text":[">> Andrew, I'm reading and hearing","about all these different data breaches,","and all these issues around database security.","For a fully managed database like Azure Cosmos DB,","I'm entrusting my data to the Cosmos DB team.","What are you doing as far as security?","What are all the things that are within","the scope of this manage service","that you're handling for as to,","help me make sure my data is secure, compliant,","and that only the authorize,","or the correct people are able to access the data.",">> Yeah. So let's give you a quick overview of all of","the security capabilities of Azure Cosmos DB.","And at a high level,","you can actually break these up into buckets.","So, some of the things you want to think","about are network security,","encryption, authorization,","and kind of tangentially related is compliance.","Really, you should always think about","security even if you don't have to","meet certain compliance requirements,","but this is also, a lot of times,","a key driver in terms of how folks think about security.","From a network perspective,","we actually offer a few things out of the box,","and this is going to be kind","of related to encryption too.","I'll explain in just a second,","but the first thing in terms of network security is","we give you the ability to set up IP firewalls.","And so, the default behavior,","just to make development easy,","is when you provision a database account on Cosmos DB,","we give you a URI and a set of keys,","and you can access them.","However, as your application","progresses and your nearing production,","what you might want to do is","actually whitelist a set of IP","addresses from the application","is brought on whether that's virtual machines,","app service, functions, or something else.","What you want to do as whitelist those","IP addresses so that way,","your database isn't just exposed on the public internet.",">> Right.",">> Tangentially related is encryption in transit.","So, let's say, how do","I protect myself against a man in the middle attack?","From encryption, what we do is we actually guarantee that","your data is both encrypted in","transit as well as at rest.","And basically,","in order to establish a connection to Cosmos DB,","we actually enforce TLS 1.2,","or SSL on that request.","Otherwise, if you try to","make a request on an encrypted line,","what we'll do is we'll just flat out deny it.","So we enforce encryption in transit.","By default, all of your data is also encrypted at rest.","So on our side,","we actually use AES encryption","to encrypt everything that we store on our drives.","Let's say you make","it past all of the armed security guards,","and really somehow, I don't know,","Ocean's Eleven you're way into a data center.","If you portal drive,","It's completely useless to you because","everything is encrypted at rest as well.","And once again, this isn't","something you turn on or turn off,","we are secure by default.","We actually believe that everything should be","encrypted both in transit and at rest.","There should be no option to turn these things off.","Honestly, I'm surprised that there are places even","allow you to turn these things off.","So, we actually encrypt everything.","From an authorization model,","you can actually break this up into two segments.","One is our control plane,","and the other is the data plane.","For the control plane,","think of this as the management of your database.","How do I do key rotation?","How do I replicate two additional regions?","Do fail-overs?","Etcetera. For data plane,","this is actually going to be","what the application itself does.","All of the CRID request,","or CORI requests actually touching the data on itself.","For the control plane what we do is,","we implement a full role-based access control model,","and you actually get this, it's the same.","Our back control is that you get with","all of the other Azure products.",">> So, if I'm already using","role-based access control of my Azure subscription,","I can go and just use the same roles,","or define new roles that have specific access,","capabilities, at that control plane into Cosmos DB?",">> Yeap. And then for the data plan,","what we do is we use a key-based authorization model.","And what we actually do here","is when a client talks to the server,","we use an HMAC signature,","that is a combination of a key and some requests details.","Their requests details are going to be things like,","what the current time is?","What is the operation you want to do?","What is the resource that you're actually operating on?","And a full URI to that resource.","What that means is that between client and server,","you're actually always guaranteed and protected","against things like a replay attack.","Let's say someone was able to break TLS 1.2,","chances are not going to happen.","But let's for sake of example,","let's say someone was actually able to breach that,","what ends up happening is","we only ship a signature over the wire,","we never actually ship any secrets over the wire.","And if they were to try to inject","the same signature for a follow up request,","because the system clock has moved on the server,","and the signature is actually no longer valid anymore.","You have a layer of protection with this.","And for this particular key,","we actually gave you a set of two master keys,","two read only keys,","and we also gave you the ability to generate","your own resource tokens.","The master keys, you can think of","as the key to everything,","like your whole kingdom.","Once you have the master key,","you can create databases,","create collections, delete databases scale them.","And we also expose read only access through a set","of read only keys if you only want to be able to read","everything underneath the database account.","We gave you two to make key rotation easy.","Best practice is to rotate your keys on a periodic basis,","like let's say six or nine months.","And the reason why we give you two is","you can use key number one,","rotate key number two,","then use key number two in the application,","and rotate key number one.","And if you do this model,","you can actually rotate keys without ever","incurring any downtime in the application.",">> Oh, wow.",">> For the resource tokens,","this requires a resource token broker,","but this is actually the means for","doing fine grained access control.","And so, within a container,","you have things like documents,","or records, some kind of items.","If you wanted to only grant access to","a specific row within the container,","what you can do is, our model is under databases,","you can create users, which have permissions.","And underneath database is also these containers.","The permissions is a tuple of a user,","this is just a logical entity.","It can be a role, it can be a user.","And either the ID,","or URI of the container,","or some underlying records.","Based off of this, the permission is","going to give you a temporary resource token.","And what you can do is you can actually then","implement a STS, right?","So, if I want to give access to an untrusted party,","what they do is they make a call to","the resource token broker.","And what this will do is, using the master key,","it will make call to database,","database will spit back resource token.","This might have some authentication there also baked in,","you might make it let's say,","active directory based, spit back the resource token.","And then this has a temporary time limit in which,","it can last up to 5 hours to","do fine grained access control within the database.","And then that way,","the user can construct","what he has access to within that database.",">> Andrew, I'll tell you. This whole inside joke","here at Microsoft that find a way to","work the valet key pattern into","every course we do on addicts,","and you just showed us through the STS,","the valet key pattern.","How we can use token broker to implement that pattern.","Really excited to learn more about this,","specifically about compliance.","So, the next video, I love to talk to","you more about how we","can implement compliance in Cosmos DB."]}